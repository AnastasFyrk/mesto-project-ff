(()=>{"use strict";var e=document.querySelector("#card-template");function t(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",r),e.addEventListener("click",n)}function o(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",r),e.removeEventListener("click",n)}function r(e){"Escape"===e.key&&o(document.querySelector(".popup_is-opened"))}function n(e){e.target.classList.contains("popup")&&o(popup)}var c,u=function(e,t,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(o.inputErrorClass),r.textContent="",r.classList.remove(o.errorClass)},i=function(e,t,o){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(o.inactiveButtonClass)):(t.disabled=!0,t.classList.add(o.inactiveButtonClass))},a=function(e,t){var o=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);o.forEach((function(t,n){u(e,t,n),i(o,r,n)}))},l={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},p=document.querySelectorAll(".popup"),s=document.querySelector(".popup_type_edit"),d=document.querySelector(".profile__edit-button"),_=document.forms["edit-profile"],m=_.querySelector(".popup__input_type_name"),f=_.querySelector(".popup__input_type_description"),y=document.querySelector(".profile__title"),v=document.querySelector(".profile__description"),S=document.querySelector(".popup_type_new-card"),q=document.querySelector(".profile__add-button"),L=document.forms["new-place"],g=L.querySelector(".popup__input_type_card-name"),E=L.querySelector(".popup__input_type_url"),C=document.querySelector(".places__list"),b=document.querySelector(".popup_type_image"),h=document.querySelector(".popup__image"),k=document.querySelector(".popup__caption"),x=document.querySelector(".popup_type_avatar");function A(e){e.target.classList.contains("card__image")&&(t(b),h.src=e.target.src,h.alt=e.target.alt,k.textContent=e.target.alt)}document.querySelector(".profile__image"),x.querySelector(".popup__input_type_avatar"),d.addEventListener("click",(function(){t(s),m.value=y.textContent,f.value=v.textContent,a(_,l)})),p.forEach((function(e){e.addEventListener("click",(function(t){(t.target.classList.contains("popup_is-opened")||t.target.classList.contains("popup__close"))&&o(e)}))})),q.addEventListener("click",(function(){a(L,l),t(S),g.value="",E.value=""})),_.addEventListener("submit",(function(e){return function(e){e.preventDefault();var t=m.value,r=f.value;editProfile(t,r).then((function(){y.textContent=t,v.textContent=r,o(s)})).catch((function(e){console.log("Ошибка при обновлении профиля: ".concat(e))}))}(e)})),L.addEventListener("submit",(function(t){t.preventDefault();var r={name:g.value,link:E.value};C.prepend(function(t,o){var r=e.content.cloneNode(!0),n=r.querySelector(".card__delete-button"),c=r.querySelector(".card__like-button"),u=r.querySelector(".card__image");return r.querySelector(".card__title").textContent=t.name,r.querySelector(".card__image").alt=t.name,r.querySelector(".card__image").src=t.link,n.addEventListener("click",(function(e){e.target.closest(".card").remove()})),c.addEventListener("click",(function(e){e.target.classList.toggle("card__like-button_is-active")})),u.addEventListener("click",o),r}(r,A)),o(S),t.target.reset()})),c=l,Array.from(document.querySelectorAll(c.formSelector)).forEach((function(e){!function(e,t){var o=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);i(o,r,t),o.forEach((function(n){n.addEventListener("input",(function(){!function(e,t,o){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?u(e,t,o):function(e,t,o,r){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r.inputErrorClass),n.textContent=o,n.classList.add(r.errorClass)}(e,t,t.validationMessage,o)}(e,n,t),i(o,r,t)}))}))}(e,c)})),fetch("https://nomoreparties.co/v1/wff-cohort-14/users/me",{method:"GET",headers:{authorization:"bd387953-a173-402f-b0be-d409295ef3a1","Content-Type":"application/json"}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))})();